{"version":3,"sources":["../../src/pages/main/salesAndgift/sale/sale.module.ts","../../src/pages/main/salesAndgift/sale/sale.ts"],"names":[],"mappings":"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","file":"23.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule, IonicPage } from 'ionic-angular';\nimport { SalePage } from './sale';\n@IonicPage()\n@NgModule({\n  declarations: [\n    SalePage,\n  ],\n  imports: [\n    IonicPageModule.forChild(SalePage),\n  ]\n \n})\nexport class SalePageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/main/salesAndgift/sale/sale.module.ts","/**\n * @author() linyunfu\n * lazy\n * */ \nimport { Component,ViewChild } from '@angular/core';\nimport { IonicPage,Platform, Navbar,NavController,ViewController, NavParams,PopoverController } from 'ionic-angular';\n// import { SaleVerifyPage } from '../sale-verify/sale-verify';\n// import { ScangiftPage } from '../scangift/scangift';\n// import { CodeviewPage } from '../codeview/codeview';\nimport { AppService } from '../../../../providers/service-public-service/service-public-service';\n\n@IonicPage()\n@Component({\n  selector: 'page-sale',\n  templateUrl: 'sale.html',\n})\nexport class SalePage {\n  @ViewChild(Navbar)navbar:Navbar;\n  // 储存 扫码过来的数据\n  data;\n  protected gifts = new Array();\n  protected goods = new Array();\n  protected presents = new Array();\n  public actIds;\n  public userId;\n  public storeId;\n  public actNum = 0;\n  public giftNum = 0;\n  public presentNum = 0;\n  public selectOptions;\n  public actMaps:Array<any>;\n  public actMapLength:number;\n  public Goods:Array<any>;\n  public GoodsLength:number;\n  public Gifts:Array<any>;\n  public GiftsLength:number;\n  // 来源\n  public sourceMap:any;\n  constructor(public navCtrl: NavController, \n    public navParams: NavParams, \n    public appService: AppService,\n    public popoverCtrl: PopoverController,\n    public viewCtrl:ViewController,\n    public platform:Platform) {\n  }\n  ionViewWillEnter(){\n    this.selectOptions = {title: '选择来源',mode: 'md'};\n    this.Gifts=new Array();\n    this.navbar.backButtonClick = (e:UIEvent)=>{\n    this.onBack();\n }\n var val=this.navParams.get('scannerData');\n// 获取上一个页面过来的数据 采用本地储存的方式\n  this.sourceMap=val['sourceMap']||{};\n  this.actIds= val['actIds']\n  this.actMaps=val['actMap']||[];\n  this.actMapLength=this.actMaps.length||0;\n  this.Goods=val['goods']||[];\n  this.GoodsLength=this.Goods.length||0;\n  this.Gifts=val['gifts']||[];\n  this.GiftsLength=this.Gifts.length||0;\n  this.goods=val['goods'];\n  this.gifts=val['gifts'];\n  // 储存\n  this.appService.getItem('pre',val=>{\n    this.presents=val['presentMap']||[];\n    this.presentNum=this.presents.length||0;\n  })\n  // 扫描显示数量\n  this.actNum = this.actMapLength;\n  this.giftNum = this.GiftsLength;\n   \n  }\n\n  ionViewDidEnter(){\n    console.log('ionViewDidEnter');\n    this.platform.registerBackButtonAction(() => {\n      this.onBack();\n    });\n  }\n\n  ionViewDidLeave(){  \n    this.platform.registerBackButtonAction(() => {\n      this.navCtrl.pop();\n    });\n  }  \n  \n  onBack(){\n    this.appService.backAlert(this.viewCtrl);\n  }\n  onScanner(){\n    this.navCtrl.pop();\n  }\n\n// 销售第一次扫码-》销售-》礼品扫码\n  onScanPresent(){\n\n    this.navCtrl.push('ScangiftPage');\n  }\n\n  //查看积分码 \n  onCodeView(codes){\n    let popover = this.popoverCtrl.create('CodeviewPage',codes);\n    popover.present();\n  }\n  \n  //查看积分码 \n  onCodeSourceView(codes){\n    let popover = this.popoverCtrl.create('CodeviewPage',codes);\n    popover.present();\n  }\n// 　处理销售逻辑\n  saleVerify() {\n    // 处理商品\n    const goods:Array<any>=[]\n    for(let item of this.goods){\n        goods.push({id:item['goodsId'],\"source\":'',actId:item['actId'],code:item.code,\"saleType\":\"0\"})\n    }\n    const gifts:Array<any>=[]\n    for(let item of this.gifts){\n        gifts.push({id:item['goodsId'],\"source\":'',actId:item['actId'],code:item.code,\"saleType\":\"1\"})\n    }\n    var resultObect = {'actIds':this.actIds,'goods':goods.concat(gifts),'gifts':this.presents,sourceMap:this.sourceMap};\n    console.log( resultObect)\n    let params = \n    {\n      data:resultObect,\n      userId:JSON.parse(window.localStorage.getItem('userInfo'))['id'],\n      storeId:JSON.parse(window.localStorage.getItem('curStore'))['id'],\n      type:this.gifts.length>0?'1':'2'\n    }\n    this.navCtrl.push('SaleVerifyPage',params,{\n      animation: 'md-transition'\n    });\n    \n  }\n\n  onAddNum(pos,num){\n   this.presents[pos].num = parseInt(num) + 1;\n  }\n\n  onCutNum(pos,num){\n    if (num == 1) {\n       this.presents.splice(pos,1);\n    }else{\n      this.presents[pos].num =  parseInt(num) - 1;\n    }\n    \n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/main/salesAndgift/sale/sale.ts"],"sourceRoot":""}