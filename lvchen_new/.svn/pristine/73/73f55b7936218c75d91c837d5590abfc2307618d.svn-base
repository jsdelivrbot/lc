{"version":3,"sources":["../../src/pages/main/myCustomer/customer-logging/customer-logging.module.ts","../../src/pages/main/myCustomer/customer-logging/customer-logging.ts"],"names":[],"mappings":"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","file":"30.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { CustomerLoggingPage } from './customer-logging';\n\n@NgModule({\n  declarations: [\n    CustomerLoggingPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(CustomerLoggingPage),\n  ],\n})\nexport class CustomerLoggingPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/main/myCustomer/customer-logging/customer-logging.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams } from 'ionic-angular';\nimport { AppService } from '../../../../providers/service-public-service/service-public-service';\n\n/**\n * Generated class for the CustomerLoggingPage page.\n *\n * See https://ionicframework.com/docs/components/#navigation for more info on\n * Ionic pages and navigation.\n */\n\n@IonicPage()\n@Component({\n  selector: 'page-customer-logging',\n  templateUrl: 'customer-logging.html',\n})\nexport class CustomerLoggingPage {\n\n  public menus: Array<any>;\n  public selectedTab = 0;\n  public babys: Array<any> = [];\n  public newBabys: Array<any> = [];\n  public remarks: string = \"\";\n  public memberPhone: string = \"\";\n  public memberName: string = \"\";\n  public isDisabled: boolean = false;\n\n  constructor(\n    public navCtrl: NavController,\n    public navParams: NavParams,\n    public appService: AppService) {\n  }\n\n  ionViewDidLoad() {\n    console.log('ionViewDidLoad CustomerLoggingPage');\n    if (this.navParams.data.type) {\n      this.isDisabled = true;\n      this.getCustomerInfo();\n    }\n  }\n\n  // 新增宝宝信息\n  addBaby() {\n    // 判断是否超过三个宝宝\n    if (this.babys.length === 3) {\n      this.appService.toast('只能添加三个宝宝！');\n\n      return;\n    }\n    // 跳转到宝宝页面\n    this.navCtrl.push('BabyInfoPage', {\n      animation: 'md-transition',\n      // 传递一个回调参数\n      callback: this.getBabyInfo\n    });\n  }\n\n  // 从宝宝页面返回时候调用\n  getBabyInfo = (data) => {\n    return new Promise((resolve, reject) => {\n      data.age = this.countAge(data.birthday) + \"岁\";\n      if (this.navParams.data.type) {\n        this.newBabys.push(data);\n      }\n      else {\n        this.babys.push(data);\n      }\n    });\n  }\n\n  // 点击下一步\n  nextStep() {\n    if (this.checkName() && this.checkRemarks()) {\n      // 验证手机\n      this.phoneIsReg();\n    }\n  }\n\n  // 计算岁数\n  countAge(date) {\n    let now = new Date()\n    date = new Date(date);\n    let age = Math.floor(Math.floor((now.getTime() - date.getTime()) / 1000 / 60 / 60 / 24) / 365);\n\n    return age;\n  }\n\n  // 判断手机号\n  phoneIsReg() {\n    // getPhone.api\n    if (!this.checkPhone(this.memberPhone)) {\n      return false;\n    }\n    // 判断是否编辑模式\n    let babyArray = this.babys;\n    let type = 0;\n    if (this.navParams.data.type) {\n      babyArray = this.newBabys;\n      type = 1;\n    }\n    console.log(babyArray)\n    this.appService.httpPost(\"getPhone.api\", { phone: this.memberPhone }, (res) => {\n      // 判断手机是否被注册\n      // 进入标签选择页面\n      if (res.code == 1 || type) {\n        this.navCtrl.push('CustomerLoggingTabsPage', {\n          animation: 'md-transition',\n          memberData: {\n            \"remarks\": this.remarks,\n            \"memberPhone\": this.memberPhone,\n            \"memberName\": this.memberName,\n            \"babys\": babyArray\n          },\n          type: type\n        });\n      }\n      else {\n        this.appService.toast(res.msg);\n        return false;\n      }\n    }, true);\n  }\n\n  // 检查手机格式\n  checkPhone(phone) {\n    if (!(/^1[345789]\\d{9}$/.test(phone))) {\n      this.appService.toast('请输入正确的手机号码！');\n      return false;\n    }\n    return true;\n  }\n\n  // 检查姓名\n  checkName() {\n    if (this.memberName.length > 15) {\n      this.appService.toast('顾客姓名不能超过15个字！');\n      return false;\n    }\n    if (this.memberName.length <= 0) {\n      this.appService.toast('请输入顾客姓名！');\n      return false;\n    }\n    return true;\n  }\n\n  // 检查备注\n  checkRemarks() {\n    if (this.remarks.length > 200) {\n      this.appService.toast('备注不能超过两百个字！');\n      return false;\n    }\n    return true;\n  }\n\n  // 获取顾客信息\n  getCustomerInfo() {\n    this.appService.httpPost('findMemberDetails.api', {\n      memberPhone: this.navParams.data.memberPhone,\n    }, (res) => {\n      if (res.code == 1) {\n        this.memberPhone = res.memberPhone;\n        this.memberName = res.memberName;\n        this.babys = res.babys;\n      }\n      else {\n        this.appService.alert(res.msg);\n      }\n    }, true)\n  }\n\n  // 编辑宝宝信息\n  editBaby(index) {\n    if (!this.navParams.data.type) {\n      this.navCtrl.push('BabyInfoPage', {\n        animation: 'md-transition',\n        // 传递一个回调参数\n        callback: this.editBabyDone,\n        type: true,\n        index: index,\n        baby: this.babys[index]\n      });\n    }\n  }\n\n  // 修改宝宝信息完成后\n  editBabyDone = (baby) => {\n    return new Promise((resolve, reject) => {\n      if (baby.del) {\n        this.babys.splice(baby.index, 1);\n        return;\n      }\n      baby.age = this.countAge(baby.birthday) + \"岁\";\n      this.babys[baby.index] = baby;\n    });\n  }\n\n  // 编辑宝宝信息\n  editBabyInEditMode(index) {\n    this.navCtrl.push('BabyInfoPage', {\n      animation: 'md-transition',\n      // 传递一个回调参数\n      callback: this.editBabyInEditModeDone,\n      type: true,\n      index: index,\n      baby: this.newBabys[index]\n    });\n  }\n\n  // 修改宝宝信息完成后\n  editBabyInEditModeDone = (baby) => {\n    return new Promise((resolve, reject) => {\n      if (baby.del) {\n        this.newBabys.splice(baby.index, 1);\n        return;\n      }\n      baby.age = this.countAge(baby.birthday) + \"岁\";\n      this.newBabys[baby.index] = baby;\n    });\n  }\n\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/main/myCustomer/customer-logging/customer-logging.ts"],"sourceRoot":""}