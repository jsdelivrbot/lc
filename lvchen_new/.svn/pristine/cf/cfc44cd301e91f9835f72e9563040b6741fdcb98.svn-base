{"version":3,"sources":["../../src/pages/main/myCustomer/my-customer/my-customer.module.ts","../../src/pages/main/myCustomer/my-customer/my-customer.ts"],"names":[],"mappings":"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","file":"28.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { MyCustomerPage } from './my-customer';\n\n@NgModule({\n  declarations: [\n    MyCustomerPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(MyCustomerPage),\n  ],\n})\nexport class MyCustomerPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/main/myCustomer/my-customer/my-customer.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams } from 'ionic-angular';\nimport { AppService } from '../../../../providers/service-public-service/service-public-service';\n\n\n/**\n * Generated class for the MyCustomerPage page.\n *\n * See https://ionicframework.com/docs/components/#navigation for more info on\n * Ionic pages and navigation.\n */\n\n@IonicPage()\n@Component({\n  selector: 'page-my-customer',\n  templateUrl: 'my-customer.html',\n})\nexport class MyCustomerPage {\n  public isCondition: boolean = false;\n  public startDate: string = '';\n  public endDate: string = '';\n  public dateTag: number = 1;\n  public memberPhone: string = '';\n  public page: number = 1;\n  public rows: string = '20';\n  public searchCondition: object = {\n    startDate: '',\n    endDate: '',\n    dateTag: 1\n  }\n  public customers: Array<any> = [];\n  public dateText: string = '当天';\n  public hasNextPage: boolean = true;\n  public canGetMoreData = true;\n  public labelId: string = \"\";\n  public labelArr: Array<any> = [];\n\n  constructor(\n    public navCtrl: NavController,\n    public navParams: NavParams,\n    public appService: AppService,) {\n  }\n\n  ionViewDidLoad() {\n    this.getCustomer(false);\n    this.getLabels();\n  }\n\n  // 搜索条件确定\n  confirmCondition() {\n    this.customers = [];\n    this.page = 1;\n    this.hasNextPage = true;\n    // 隐藏条件模块\n    this.isCondition = false;\n    // 点击了确定按钮才保存搜索条件\n    this.searchCondition = {\n      startDate: this.startDate,\n      endDate: this.endDate,\n      dateTag: this.dateTag\n    }\n    // 改变搜索条件显示\n    this.dateText = this.dateTag == 1 ? \"当天\" : this.dateTag == 2 ? \"昨天\" : \"当月\";\n    if (this.startDate != '' || this.endDate != '') {\n      this.dateText = '自定义';\n    }\n    // 获取数据\n    this.getCustomer(false);\n    // 先设置不能再获取数据，异步获取数据后会判断还能不能获取数据\n    this.canGetMoreData = false;\n  }\n\n  // 关闭搜索条件\n  closeCondition($event) {\n    if ($event.target.className != \"condition-cover\") {\n      return;\n    }\n    this.isCondition = false;\n  }\n\n  // 显示搜索条件\n  condition() {\n    this.isCondition = !this.isCondition;\n  }\n\n  // 选择时间\n  selectTime(type) {\n    this.dateTag = type;\n    this.startDate = '';\n    this.endDate = '';\n  }\n\n  // 查看顾客详细信息\n  checkInfo(memberPhone) {\n    this.navCtrl.push('MyCustomerInfoPage', { memberPhone: memberPhone, type: false });\n  }\n\n  // 获取顾客数据\n  getCustomer($event) {\n    if (this.memberPhone != '') {\n      // 手机号码错误\n      if (!this.checkPhone(this.memberPhone)) {\n        // 完成本次加载\n        if ($event) {\n          $event.complete();\n        }\n        // 让上拉加载消失\n        this.hasNextPage = false;\n        // 过一会才让它可以继续请求数据\n        setTimeout(() => {\n          this.canGetMoreData = true;\n        }, 500)\n        return;\n      }\n    }\n    // 判断是否可以继续请求数据\n    if (!this.canGetMoreData) {\n      return;\n    }\n    this.appService.httpPost('findUserHasMembers.api', {\n      startToDate: this.searchCondition['startDate'],\n      endToDate: this.searchCondition['endDate'],\n      dateTag: this.searchCondition['dateTag'],\n      memberPhone: this.memberPhone,\n      labelId: this.labelId,\n      page: this.page,\n      rows: this.rows,\n    }, (res) => {\n      if (res.code == 1) {\n        for (let i = 0; i < res.list.length; i++) {\n          this.customers.push(res.list[i]);\n        }\n        // 完成本次加载\n        if ($event) {\n          $event.complete();\n        }\n        // 判断是否还有下一页\n        if (res.list.length < this.rows) {\n          // 没有的话让上拉加载消失\n          this.hasNextPage = false;\n        }\n        else {\n          this.hasNextPage = true;\n        }\n        this.canGetMoreData = true;\n      }\n      else {\n        this.hasNextPage = false;\n        if ($event) {\n          $event.complete();\n        }\n        this.appService.alert(res.msg);\n      }\n    })\n  }\n\n  // 搜索按钮\n  searchButton() {\n    // 重置搜索条件个结果\n    this.customers = [];\n    this.page = 1;\n    this.hasNextPage = true;\n    // 获取数据\n    this.getCustomer(false);\n    this.canGetMoreData = false;\n  }\n\n  // 上拉加载\n  getMoreData($event) {\n    this.page++;\n    this.getCustomer($event);\n  }\n\n  // 检查手机格式\n  checkPhone(phone) {\n    if (!(/^1[345789]\\d{9}$/.test(phone))) {\n      this.appService.alert(\"请填写正确的手机号码！\");\n      return false;\n    }\n    return true;\n  }\n\n  // 获取标签\n  getLabels() {\n    this.appService.httpPost(\"brandSelection.api\", {}, (res) => {\n      console.log(res);\n      if (res.code == 1) {\n        this.labelArr = res.data;\n      }\n    });\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/main/myCustomer/my-customer/my-customer.ts"],"sourceRoot":""}